

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Selecting dataframe rows that satisfy a boolean expression &#8212; Introduction to Data Science for Mechanical Engineers (Lecture Book)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lecture06/python-pandas-selections';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Homework 6" href="homework_06.html" />
    <link rel="prev" title="Python loops" href="python-loops.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">Introduction to Data Science for Mechanical Engineers (Lecture Book)</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Preface
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture01/intro.html">Lecture 1: Introduction</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture01/what-is-data-science.html">What is data science?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture01/cool-applications.html">Some cool appliations of data science in mechanical engineering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture01/python-intro.html">Why Python?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture01/python-expressions.html">Python expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture01/python-variables-and-types.html">Python variables and types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture01/homework_01.html">Homework 1</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture02/intro.html">Lecture 2: Data arrays</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture02/python-tuples.html">Python tuples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture02/python-lists.html">Python lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture02/python-numpy.html">Numerical Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture02/homework_02.html">Homework 2</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture03/intro.html">Lecture 3: Data loading and selection</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture03/python-matrices.html">Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture03/python-csv-files.html">Comma-separated values file format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture03/python-pandas.html">The Python Data Analysis Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture03/homework_03.html">Homework 3</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture04/intro.html">Lecture 4: Data visualization</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture04/python-plotting.html">Plotting simple functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture04/python-plot-noisy.html">Plotting noisy measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture04/python-scatter.html">Scatter plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture04/python-histograms.html">Histograms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture04/homework_04.html">Homework 4</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture05/intro.html">Lecture 5: Functions, data manipulation, and models</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture05/python-strings.html">Basics of strings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture05/python-print.html">The print function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture05/python-functions.html">Python functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture05/applying-functions-to-dataframes.html">Applying functions to dataframes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture05/models-are-functions.html">Models are functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture05/homework_05.html">Homework 5</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">Lecture 6: Conditionals and loops</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="python-conditionals.html">Python conditionals</a></li>
<li class="toctree-l2"><a class="reference internal" href="python-loops.html">Python loops</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Selecting dataframe rows that satisfy a boolean expression</a></li>
<li class="toctree-l2"><a class="reference internal" href="homework_06.html">Homework 6</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture07/intro.html">Lecture 7: Probability as a measure of uncertainty</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture07/probability-and-state-of-knowledge.html">Probability as a representation of our state of knowledge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture07/probability-common-sense.html">The common sense assumptions that give rise to the basic probability rules.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture07/principle-of-insufficient-reason.html">The principle of insufficient reason</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture07/estimating-probabilities-by-simulation.html">Estimating probabilities by simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture07/estimating-probabilities-from-data.html">Estimating probabilities from data - Bootstrapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture07/homework_07.html">Homework 7</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture08/intro.html">Lecture 8: The basic rules of probability</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture08/probability-rules.html">The basic rules of probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture08/probability-urn-example.html">Example - Drawing balls from a box without replacement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture08/probability-of-disjunction.html">Probability of logical disjunctions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture08/probability-sum-rule.html">The sum rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture08/probability-urn-example-sum-rule.html">Example - Drawing balls from a box without replacement (sum rule)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture08/probability-urn-example-information-flow.html">Example - Drawing balls from a box without replacement (information flow)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture08/homework_08.html">Homework 8</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture09/intro.html">Lecture 9: Discrete random variables</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture09/discrete-random-variables.html">Discrete Random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture09/probability-mass-function.html">The probability mass function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture09/the-bernoulli-distribution.html">The Bernoulli distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture09/properties-of-the-probability-mass-function.html">Properties of the probability mass function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture09/the-categorical-distribution.html">The Categorical distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture09/the-binomial-distribution.html">The Binomial Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture09/the-poisson-distribution.html">The Poisson distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture09/homework_09.html">Homework 9</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture10/intro.html">Lecture 10: Continuous random variables</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture10/continuous-random-variables.html">Continuous random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture10/example-manufacturing-steel-balls.html">Example: Uncertainties in steel ball manufacturing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture10/cumulative-distribution-function.html">The cumulative distribution function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture10/probability-density-function.html">The probability density function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture10/the-uniform-distribution.html">The uniform distribution</a></li>

<li class="toctree-l2"><a class="reference internal" href="../lecture10/homework_10.html">Homework 10</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture11/intro.html">Lecture 11: Expectations, variances, and their properties</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/expectation-discrete-rv.html">Expectation of discrete random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/examples-expectation-of-discrete-rvs.html">Examples of expectations of discrete random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/expectation-continuous-rv.html">Expectation of a continuous random variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/expectation-notation.html">Simplifying our notation about expectations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/properties-of-expectations.html">Properties of expectations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/variance.html">Variance of a random variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/properties-of-variance.html">Properties of variance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/examples-variance.html">Examples of variances of random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/homework_11.html">Homework 11</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture12/intro.html">Lecture 12: The Normal distribution, quantiles, and credible intervals</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture12/the-standard-normal.html">The standard Normal distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture12/standard-normal-quantiles.html">Quantiles of the standard Normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture12/the-normal.html">The Normal distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture12/normal-quantiles.html">Quantiles of the Normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture12/example-fitting-normals.html">Fitting Normal distributions to data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture12/homework_12.html">Homework 12</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture13/intro.html">Lecture 13: Fitting models with the principle of maximum likelihood</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture13/joint-probability-density-function.html">The joint probability density function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture13/repeated-experiments.html">Repeated independent experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture13/the-maximum-likelihood-principle.html">The maximum likelihood principle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture13/fitting-the-normal-with-maximum-likelihood.html">Fitting the parameters of a Normal using the maximum likelihood principle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture13/fitting-the-bernoulli.html">Fitting the Bernoulli with maximum likelihood</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture13/predictive-checking.html">Predictive checking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture13/homework_13.html">Homework 13</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture14/intro.html">Lecture 14: Covariance, correlation, and linear regression with one variable</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture14/covariance.html">Covariance between two random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture14/correlation.html">Correlation between two random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture14/correlation-is-not-causation.html">Correlation is not causation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture14/uncorrelated-does-not-imply-independent.html">Two uncorrelated random variables are not necessarily independent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture14/linear-regression-with-one-variable.html">Linear regression with one variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture14/homework_14.html">Homework 14</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture15/intro.html">Lecture 15: Linear regression</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/regression-with-one-variable-revisited.html">Regression with one variable revisited</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/example-linear-regression.html">Example: Linear regression with a single variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/polynomial-regression.html">Polynomial Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/the-generalized-linear-model.html">The generalized linear model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/regression-diagnostics.html">Measures of Predictive Accuracy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/cross-validation.html">Cross validation for selecting the number of basis functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/maximum-likelihood-interpretation.html">Maximum likelihood interpretation of least squares</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/maximum-likelihood-example.html">Example: Regression with estimated measurement noise</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/homework_15.html">Homework 15</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture16/intro.html">Lecture 16: Classification via logistic regression</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture16/logistic-regression.html">Logistic regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture16/example-logistic-regression-one-variable.html">Example: Logistic regression with one variable (High melting explosives)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture16/example-logistic-regression-many-features.html">Logistic regression with many features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture16/classification-diagnostics.html">Diagnostics for Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture16/homework_16.html">Homework 16</a></li>

</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/PurdueMechanicalEngineering/me-239-intro-to-data-science/master?urlpath=lab/tree/lecture06/python-pandas-selections.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/PurdueMechanicalEngineering/me-239-intro-to-data-science/blob/master/lecture06/python-pandas-selections.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lecture06/python-pandas-selections.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Selecting dataframe rows that satisfy a boolean expression</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-rows-that-satisfy-single-boolean-expression">Extract rows that satisfy single boolean expression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#questions">Questions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-timeseries-data">Plotting timeseries data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Questions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Questions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-rows-that-satisfy-more-complicated-boolean-expressions">Extract rows that satisfy more complicated boolean expressions</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="selecting-dataframe-rows-that-satisfy-a-boolean-expression">
<span id="lecture06-selecting-rows"></span><h1>Selecting dataframe rows that satisfy a boolean expression<a class="headerlink" href="#selecting-dataframe-rows-that-satisfy-a-boolean-expression" title="Permalink to this heading">#</a></h1>
<p>We are now going to put to use what we learned about Python boolean expressions to extract rows from a dataframe that satisfy certain criteria.</p>
<section id="extract-rows-that-satisfy-single-boolean-expression">
<h2>Extract rows that satisfy single boolean expression<a class="headerlink" href="#extract-rows-that-satisfy-single-boolean-expression" title="Permalink to this heading">#</a></h2>
<p>Let’s do this by example.
Let’s load again the <code class="docutils literal notranslate"><span class="pre">temperature_raw.xlsx</span></code> dataset we played with in <a class="reference internal" href="../lecture05/models-are-functions.html#lecture05-models-are-functions"><span class="std std-ref">Models are functions</span></a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MAKE_BOOK_FIGURES</span><span class="o">=</span><span class="kc">False</span>

<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib_inline</span>
<span class="n">matplotlib_inline</span><span class="o">.</span><span class="n">backend_inline</span><span class="o">.</span><span class="n">set_matplotlib_formats</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;paper&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">set_book_style</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-v0_8-white&#39;</span><span class="p">)</span> 
    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">)</span>

    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
        <span class="c1"># Font settings</span>
        <span class="s1">&#39;font.family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span>  <span class="c1"># For academic publishing</span>
        <span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>  <span class="c1"># As requested, 10pt font</span>
        <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
        <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
        <span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>  <span class="c1"># Slightly smaller for better readability</span>
        <span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
        <span class="s1">&#39;legend.fontsize&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
        
        <span class="c1"># Line and marker settings for consistency</span>
        <span class="s1">&#39;axes.linewidth&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="s1">&#39;grid.linewidth&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="s1">&#39;lines.linewidth&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s1">&#39;lines.markersize&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        
        <span class="c1"># Layout to prevent clipped labels</span>
        <span class="s1">&#39;figure.constrained_layout.use&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        
        <span class="c1"># Default DPI (will override when saving)</span>
        <span class="s1">&#39;figure.dpi&#39;</span><span class="p">:</span> <span class="mi">600</span><span class="p">,</span>
        <span class="s1">&#39;savefig.dpi&#39;</span><span class="p">:</span> <span class="mi">600</span><span class="p">,</span>
        
        <span class="c1"># Despine - remove top and right spines</span>
        <span class="s1">&#39;axes.spines.top&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;axes.spines.right&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        
        <span class="c1"># Remove legend frame</span>
        <span class="s1">&#39;legend.frameon&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        
        <span class="c1"># Additional trim settings</span>
        <span class="s1">&#39;figure.autolayout&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Alternative to constrained_layout</span>
        <span class="s1">&#39;savefig.bbox&#39;</span><span class="p">:</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span>    <span class="c1"># Trim when saving</span>
        <span class="s1">&#39;savefig.pad_inches&#39;</span><span class="p">:</span> <span class="mf">0.1</span>   <span class="c1"># Small padding to ensure nothing gets cut off</span>
    <span class="p">})</span>

<span class="k">def</span> <span class="nf">save_for_book</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">is_vector</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save a figure with book-optimized settings.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    fig : matplotlib figure</span>
<span class="sd">        The figure to save</span>
<span class="sd">    filename : str</span>
<span class="sd">        Filename without extension</span>
<span class="sd">    is_vector : bool</span>
<span class="sd">        If True, saves as vector at 1000 dpi. If False, saves as raster at 600 dpi.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional kwargs to pass to savefig</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="c1"># Set appropriate DPI and format based on figure type</span>
    <span class="k">if</span> <span class="n">is_vector</span><span class="p">:</span>
        <span class="n">dpi</span> <span class="o">=</span> <span class="mi">1000</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;.pdf&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dpi</span> <span class="o">=</span> <span class="mi">600</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;.tif&#39;</span>
    
    <span class="c1"># Save the figure with book settings</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">make_full_width_fig</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">4.7</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">make_half_width_fig</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">2.35</span><span class="p">,</span> <span class="mf">1.45</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">if</span> <span class="n">MAKE_BOOK_FIGURES</span><span class="p">:</span>
    <span class="n">set_book_style</span><span class="p">()</span>
<span class="n">make_full_width_fig</span> <span class="o">=</span> <span class="n">make_full_width_fig</span> <span class="k">if</span> <span class="n">MAKE_BOOK_FIGURES</span> <span class="k">else</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">make_half_width_fig</span> <span class="o">=</span> <span class="n">make_half_width_fig</span> <span class="k">if</span> <span class="n">MAKE_BOOK_FIGURES</span> <span class="k">else</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>curl<span class="w"> </span>-O<span class="w"> </span><span class="s1">&#39;https://raw.githubusercontent.com/PurdueMechanicalEngineering/me-239-intro-to-data-science/master/data/temperature_raw.xlsx&#39;</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;temperature_raw.xlsx&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  277k  100  277k    0     0   937k      0 --:--:-- --:--:-- --:--:--  939k
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>household</th>
      <th>date</th>
      <th>score</th>
      <th>t_out</th>
      <th>t_unit</th>
      <th>hvac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a1</td>
      <td>2018-01-07</td>
      <td>100.0</td>
      <td>4.283373</td>
      <td>66.693229</td>
      <td>246.473231</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a10</td>
      <td>2018-01-07</td>
      <td>100.0</td>
      <td>4.283373</td>
      <td>66.356134</td>
      <td>5.492116</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a11</td>
      <td>2018-01-07</td>
      <td>58.0</td>
      <td>4.283373</td>
      <td>71.549132</td>
      <td>402.094327</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a12</td>
      <td>2018-01-07</td>
      <td>64.0</td>
      <td>4.283373</td>
      <td>73.429514</td>
      <td>211.692244</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a13</td>
      <td>2018-01-07</td>
      <td>100.0</td>
      <td>4.283373</td>
      <td>63.923937</td>
      <td>0.850536</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Recall that we made a simple model between the weekly average of the consumed energy in kWh <code class="docutils literal notranslate"><span class="pre">hvac</span></code> and the average weekly external temperature <code class="docutils literal notranslate"><span class="pre">t_out</span></code>.
The model was:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">hvac_model</span><span class="p">(</span><span class="n">t_out</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">t_out_min</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A naïve model of weekly HVAC energy consumption (kWh) as a function of external temperature t_out.</span>
<span class="sd">    The mathematical form of the model is:</span>
<span class="sd">    </span>
<span class="sd">        hvac = a * (t_out - t_out_min)^2 + b</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    t_out      -   The average external temperature in degrees F (average over a week).</span>
<span class="sd">    a          -   A parameter to be calibrated using observed data. In units of kWh / (deg F)^2.</span>
<span class="sd">    b          -   Another parameter to be calibrated using observed data. This is in units of kWh.</span>
<span class="sd">                   It is the energy consumption when the HVAC system is not used.</span>
<span class="sd">    t_out_min  -   The external temperature above at which the occupants feel comfortable without using</span>
<span class="sd">                   their HVAC system.</span>
<span class="sd">    </span>
<span class="sd">    Returns: The weekly HVAC energy consumption in kWh.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_out</span> <span class="o">-</span> <span class="n">t_out_min</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">b</span>
</pre></div>
</div>
</div>
</div>
<p>and the predictions looked like this:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">a</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># in kWh / F^2</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1"># in kWh</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">make_full_width_fig</span><span class="p">()</span>

<span class="c1"># First the scatter plot of all the data we have</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed data&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t_out (F)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;hvac (kWh)&#39;</span><span class="p">)</span>

<span class="c1"># Now pick some temperatures to use our model on:</span>
<span class="n">t_outs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">predicted_hvac</span> <span class="o">=</span> <span class="n">hvac_model</span><span class="p">(</span><span class="n">t_outs</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_outs</span><span class="p">,</span> <span class="n">predicted_hvac</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Model predictons&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/a8875a6aee49c6be3f4468305d7ba09d9e71bf941f76ad3a6241a24fb5766006.svg" src="../_images/a8875a6aee49c6be3f4468305d7ba09d9e71bf941f76ad3a6241a24fb5766006.svg" /></div>
</div>
<p>Clearly, this model represents some sort of average behavior.
Let’s use see how specific households perform.
Here is how many households we have:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;household&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;a1&#39;, &#39;a10&#39;, &#39;a11&#39;, &#39;a12&#39;, &#39;a13&#39;, &#39;a16&#39;, &#39;a2&#39;, &#39;a3&#39;, &#39;a4&#39;, &#39;a5&#39;,
       &#39;a6&#39;, &#39;a7&#39;, &#39;a8&#39;, &#39;a9&#39;, &#39;b17&#39;, &#39;b18&#39;, &#39;b19&#39;, &#39;b20&#39;, &#39;b21&#39;, &#39;b22&#39;,
       &#39;b23&#39;, &#39;b24&#39;, &#39;b25&#39;, &#39;b26&#39;, &#39;b28&#39;, &#39;b29&#39;, &#39;b30&#39;, &#39;b31&#39;, &#39;b33&#39;,
       &#39;c34&#39;, &#39;c35&#39;, &#39;c36&#39;, &#39;c37&#39;, &#39;c38&#39;, &#39;c39&#39;, &#39;c40&#39;, &#39;c41&#39;, &#39;c42&#39;,
       &#39;c43&#39;, &#39;c44&#39;, &#39;c45&#39;, &#39;c46&#39;, &#39;c47&#39;, &#39;c48&#39;, &#39;c49&#39;, &#39;c50&#39;, &#39;a15&#39;,
       &#39;a14&#39;, &#39;b32&#39;, &#39;b27&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>How can we extract the data for say household <code class="docutils literal notranslate"><span class="pre">a1</span></code>?
You can do it as follows.
First, notice that you can use a boolean expression directly on the column <code class="docutils literal notranslate"><span class="pre">household</span></code>.
The result is an an array with <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> indicating the value of the boolean expression on the corresponding rows.
Here it is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;household&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;a1&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        True
1       False
2       False
3       False
4       False
        ...  
5643    False
5644    False
5646    False
5647    False
5649    False
Name: household, Length: 4887, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>Now, if you feed this array of booleans to the dataframe, it will understand that you only want to keep the rows that are <code class="docutils literal notranslate"><span class="pre">True</span></code>.
Here it is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;household&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;a1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>household</th>
      <th>date</th>
      <th>score</th>
      <th>t_out</th>
      <th>t_unit</th>
      <th>hvac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a1</td>
      <td>2018-01-07</td>
      <td>100.0</td>
      <td>4.28</td>
      <td>66.69</td>
      <td>246.47</td>
    </tr>
    <tr>
      <th>50</th>
      <td>a1</td>
      <td>2018-01-14</td>
      <td>98.0</td>
      <td>33.44</td>
      <td>67.81</td>
      <td>116.95</td>
    </tr>
    <tr>
      <th>100</th>
      <td>a1</td>
      <td>2018-01-21</td>
      <td>100.0</td>
      <td>19.58</td>
      <td>66.51</td>
      <td>116.13</td>
    </tr>
    <tr>
      <th>150</th>
      <td>a1</td>
      <td>2018-01-28</td>
      <td>96.0</td>
      <td>41.08</td>
      <td>69.58</td>
      <td>61.09</td>
    </tr>
    <tr>
      <th>200</th>
      <td>a1</td>
      <td>2018-02-04</td>
      <td>96.0</td>
      <td>30.07</td>
      <td>70.09</td>
      <td>61.35</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4700</th>
      <td>a1</td>
      <td>2019-10-27</td>
      <td>97.0</td>
      <td>54.83</td>
      <td>73.62</td>
      <td>8.56</td>
    </tr>
    <tr>
      <th>4750</th>
      <td>a1</td>
      <td>2019-11-03</td>
      <td>98.0</td>
      <td>45.93</td>
      <td>72.46</td>
      <td>14.33</td>
    </tr>
    <tr>
      <th>4800</th>
      <td>a1</td>
      <td>2019-11-10</td>
      <td>97.0</td>
      <td>40.18</td>
      <td>72.45</td>
      <td>10.76</td>
    </tr>
    <tr>
      <th>4850</th>
      <td>a1</td>
      <td>2019-11-17</td>
      <td>99.0</td>
      <td>32.20</td>
      <td>71.45</td>
      <td>11.83</td>
    </tr>
    <tr>
      <th>4900</th>
      <td>a1</td>
      <td>2019-11-24</td>
      <td>97.0</td>
      <td>39.33</td>
      <td>70.90</td>
      <td>8.46</td>
    </tr>
  </tbody>
</table>
<p>82 rows × 6 columns</p>
</div></div></div>
</div>
<p>So, there are 82 rows corresponding to this household.
If you wanted to find rows of another household, say <code class="docutils literal notranslate"><span class="pre">b17</span></code>, you do this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;household&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;b17&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>household</th>
      <th>date</th>
      <th>score</th>
      <th>t_out</th>
      <th>t_unit</th>
      <th>hvac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>b17</td>
      <td>2018-01-07</td>
      <td>73.0</td>
      <td>4.28</td>
      <td>74.91</td>
      <td>330.89</td>
    </tr>
    <tr>
      <th>66</th>
      <td>b17</td>
      <td>2018-01-14</td>
      <td>70.0</td>
      <td>33.44</td>
      <td>75.11</td>
      <td>163.87</td>
    </tr>
    <tr>
      <th>116</th>
      <td>b17</td>
      <td>2018-01-21</td>
      <td>69.0</td>
      <td>19.58</td>
      <td>74.96</td>
      <td>296.65</td>
    </tr>
    <tr>
      <th>166</th>
      <td>b17</td>
      <td>2018-01-28</td>
      <td>70.0</td>
      <td>41.08</td>
      <td>74.63</td>
      <td>146.17</td>
    </tr>
    <tr>
      <th>216</th>
      <td>b17</td>
      <td>2018-02-04</td>
      <td>79.0</td>
      <td>30.07</td>
      <td>74.34</td>
      <td>244.35</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5416</th>
      <td>b17</td>
      <td>2020-02-02</td>
      <td>92.0</td>
      <td>33.66</td>
      <td>70.94</td>
      <td>101.67</td>
    </tr>
    <tr>
      <th>5466</th>
      <td>b17</td>
      <td>2020-02-09</td>
      <td>95.0</td>
      <td>38.12</td>
      <td>71.55</td>
      <td>109.25</td>
    </tr>
    <tr>
      <th>5516</th>
      <td>b17</td>
      <td>2020-02-16</td>
      <td>92.0</td>
      <td>28.55</td>
      <td>71.43</td>
      <td>182.11</td>
    </tr>
    <tr>
      <th>5566</th>
      <td>b17</td>
      <td>2020-02-23</td>
      <td>92.0</td>
      <td>33.93</td>
      <td>69.29</td>
      <td>139.91</td>
    </tr>
    <tr>
      <th>5616</th>
      <td>b17</td>
      <td>2020-02-25</td>
      <td>95.0</td>
      <td>43.64</td>
      <td>72.25</td>
      <td>8.29</td>
    </tr>
  </tbody>
</table>
<p>113 rows × 6 columns</p>
</div></div></div>
</div>
<p>So, we have 113 rows for household <code class="docutils literal notranslate"><span class="pre">b17</span></code>.
The difference in the entries is likely due to sensor malfunction.
Now, let’s redo our scatter plot but using different colors for <code class="docutils literal notranslate"><span class="pre">a1</span></code> and <code class="docutils literal notranslate"><span class="pre">b17</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">make_full_width_fig</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;All households&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Do the scatter plot for a1</span>
<span class="n">a1_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;household&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;a1&#39;</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">a1_df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">a1_df</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Household a1&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="c1"># and the scatter plot for b17</span>
<span class="n">b17_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;household&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;b17&#39;</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">b17_df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">b17_df</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Household b17&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>

<span class="c1"># The labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t_out (F)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;hvac (kWh)&#39;</span><span class="p">)</span>

<span class="c1"># Plot also our model.</span>
<span class="n">predicted_hvac</span> <span class="o">=</span> <span class="n">hvac_model</span><span class="p">(</span><span class="n">t_outs</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_outs</span><span class="p">,</span> <span class="n">predicted_hvac</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Model predictons&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

<span class="n">save_for_book</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;ch6.fig1&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/75e319edcf724be28e8c9a10e3c96c0766915d9f01a24e5145b2277e5869eaab.svg" src="../_images/75e319edcf724be28e8c9a10e3c96c0766915d9f01a24e5145b2277e5869eaab.svg" /></div>
</div>
<p>Notice the difference in behavior between the two households.
Household <code class="docutils literal notranslate"><span class="pre">a1</span></code> is using less energy during the heating season, but more during the cooling season.</p>
<section id="questions">
<h3>Questions<a class="headerlink" href="#questions" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Modify the plot above to add data from household <code class="docutils literal notranslate"><span class="pre">c36</span></code>.</p></li>
</ul>
</section>
</section>
<section id="plotting-timeseries-data">
<h2>Plotting timeseries data<a class="headerlink" href="#plotting-timeseries-data" title="Permalink to this heading">#</a></h2>
<p>Since we have extracted the data for units <code class="docutils literal notranslate"><span class="pre">a1</span></code> and <code class="docutils literal notranslate"><span class="pre">b17</span></code>, we have a good opportunity to demonstrate another set of useful plots that you can do with dataframes.
We can now plot <code class="docutils literal notranslate"><span class="pre">t_unit</span></code> as a function of the <code class="docutils literal notranslate"><span class="pre">date</span></code> for each one of these units.
Let’s do it step by step.
First, see this plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">a1_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t_unit&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Household a1&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;date&#39;&gt;
</pre></div>
</div>
<img alt="../_images/1e96e1ce38b5a53a3084514892782de66a7f7acb5f60846df8fb55f9057910cf.svg" src="../_images/1e96e1ce38b5a53a3084514892782de66a7f7acb5f60846df8fb55f9057910cf.svg" /></div>
</div>
<p>Now, there are some data missing during Spring of 2019 and the dataframe is automatically interpolating.
We could change the style of the plot so that we see the individual data points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">a1_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t_unit&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Household a1&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7d4c05ec6216365c83a8e5e6529a63c01db766baac8ca2ade0bfe2c23b913548.svg" src="../_images/7d4c05ec6216365c83a8e5e6529a63c01db766baac8ca2ade0bfe2c23b913548.svg" /></div>
</div>
<p>And here is how you can add the temperature of another unit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">make_full_width_fig</span><span class="p">()</span>
<span class="n">a1_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t_unit&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Household a1&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">b17_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t_unit&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Household b17&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;d--&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Unit temperature (degrees F)&#39;</span><span class="p">)</span>
<span class="n">save_for_book</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;ch6.fig2&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/51df8825890c869a7c49fbdb6d79087631a1072c0baad889b04e18aec40587d0.svg" src="../_images/51df8825890c869a7c49fbdb6d79087631a1072c0baad889b04e18aec40587d0.svg" /></div>
</div>
<p>We confirm that</p>
<section id="id1">
<h3>Questions<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>In the figure of <code class="docutils literal notranslate"><span class="pre">t_unit</span></code> vs <code class="docutils literal notranslate"><span class="pre">date</span></code> above, add data from household <code class="docutils literal notranslate"><span class="pre">c36</span></code>.</p></li>
<li><p>For households <code class="docutils literal notranslate"><span class="pre">a1</span></code>, <code class="docutils literal notranslate"><span class="pre">b17</span></code> and <code class="docutils literal notranslate"><span class="pre">c36</span></code> plot <code class="docutils literal notranslate"><span class="pre">hvac</span></code> as a function of the <code class="docutils literal notranslate"><span class="pre">date</span></code>.</p></li>
</ul>
<p>So far we manually extracted the data we needed for each unit.
Now, I will show you how you can do it for as many units as you like using a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.
Let’s say we have a list of households we want to plot.
We need to plot the data for each household using a different marker.
How can we loop over pairs of household names and markers?
The most elegant way to do this is by using the <code class="docutils literal notranslate"><span class="pre">zip</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">households</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;a3&#39;</span><span class="p">,</span> <span class="s1">&#39;a4&#39;</span><span class="p">,</span> <span class="s1">&#39;a5&#39;</span><span class="p">]</span>
<span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">households</span><span class="p">,</span> <span class="n">markers</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a1 o
a2 s
a3 d
a4 p
a5 x
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">zip</span></code> function takes two lists and returns a list of pairs. Actually, you get back a object called an \emph{iterator}, but you can think of it as a list of pairs.
Each pair contains one element from the first list and one from the second.
Let’s redo our scatter plot for a list of households:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">make_full_width_fig</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;All households&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">households</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;a3&#39;</span><span class="p">,</span> <span class="s1">&#39;a4&#39;</span><span class="p">,</span> <span class="s1">&#39;a5&#39;</span><span class="p">]</span>
<span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">households</span><span class="p">,</span> <span class="n">markers</span><span class="p">):</span>
    <span class="n">df_tmp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;household&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">h</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_tmp</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df_tmp</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Household &#39;</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t_out (F)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;hvac (kWh)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">save_for_book</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;ch6.fig3&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/71c1c15d14d45a64087d625a3219c123557ae8cf94f36bf541501ab9f499332f.svg" src="../_images/71c1c15d14d45a64087d625a3219c123557ae8cf94f36bf541501ab9f499332f.svg" /></div>
</div>
</section>
<section id="id2">
<h3>Questions<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Modify the code above so that you plot the scatter plot for the first 5 of the <code class="docutils literal notranslate"><span class="pre">c??</span></code> households.</p></li>
<li><p>For the same households as above, plot <code class="docutils literal notranslate"><span class="pre">hvac</span></code> as a function of <code class="docutils literal notranslate"><span class="pre">date</span></code>.</p></li>
</ul>
</section>
</section>
<section id="extract-rows-that-satisfy-more-complicated-boolean-expressions">
<h2>Extract rows that satisfy more complicated boolean expressions<a class="headerlink" href="#extract-rows-that-satisfy-more-complicated-boolean-expressions" title="Permalink to this heading">#</a></h2>
<p>Let’s say that we want to see how the selection of <code class="docutils literal notranslate"><span class="pre">t_unit</span></code> (temperature setpoint) affects <code class="docutils literal notranslate"><span class="pre">hvac</span></code> (energy consumption) during the heating season.
We are on heating season for sure when the external temperature is smaller than 55 degrees F.
So, we need to extract all the rows with <code class="docutils literal notranslate"><span class="pre">df['t_out']</span> <span class="pre">&lt;</span> <span class="pre">55</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_heating</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">55</span><span class="p">]</span>
<span class="n">df_heating</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>household</th>
      <th>date</th>
      <th>score</th>
      <th>t_out</th>
      <th>t_unit</th>
      <th>hvac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a1</td>
      <td>2018-01-07</td>
      <td>100.0</td>
      <td>4.28</td>
      <td>66.69</td>
      <td>246.47</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a10</td>
      <td>2018-01-07</td>
      <td>100.0</td>
      <td>4.28</td>
      <td>66.36</td>
      <td>5.49</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a11</td>
      <td>2018-01-07</td>
      <td>58.0</td>
      <td>4.28</td>
      <td>71.55</td>
      <td>402.09</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a12</td>
      <td>2018-01-07</td>
      <td>64.0</td>
      <td>4.28</td>
      <td>73.43</td>
      <td>211.69</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a13</td>
      <td>2018-01-07</td>
      <td>100.0</td>
      <td>4.28</td>
      <td>63.92</td>
      <td>0.85</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5643</th>
      <td>c44</td>
      <td>2020-02-25</td>
      <td>59.0</td>
      <td>43.64</td>
      <td>76.49</td>
      <td>19.14</td>
    </tr>
    <tr>
      <th>5644</th>
      <td>c45</td>
      <td>2020-02-25</td>
      <td>87.0</td>
      <td>43.64</td>
      <td>71.17</td>
      <td>30.79</td>
    </tr>
    <tr>
      <th>5646</th>
      <td>c47</td>
      <td>2020-02-25</td>
      <td>97.0</td>
      <td>43.64</td>
      <td>68.60</td>
      <td>5.34</td>
    </tr>
    <tr>
      <th>5647</th>
      <td>c48</td>
      <td>2020-02-25</td>
      <td>92.0</td>
      <td>43.64</td>
      <td>73.43</td>
      <td>18.04</td>
    </tr>
    <tr>
      <th>5649</th>
      <td>c50</td>
      <td>2020-02-25</td>
      <td>59.0</td>
      <td>43.64</td>
      <td>77.72</td>
      <td>14.41</td>
    </tr>
  </tbody>
</table>
<p>2741 rows × 6 columns</p>
</div></div></div>
</div>
<p>Now, we are going to draw the scatter plot between <code class="docutils literal notranslate"><span class="pre">t_out</span></code> and <code class="docutils literal notranslate"><span class="pre">hvac</span></code>, but we are going to color the points according to the unit temperature <code class="docutils literal notranslate"><span class="pre">t_unit</span></code>.
Let’s first pick the rows with <code class="docutils literal notranslate"><span class="pre">t_unit</span></code> between 70 and 72 degrees F.</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_heating_70to72</span> <span class="o">=</span> <span class="n">df_heating</span><span class="p">[</span><span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">70</span> <span class="ow">and</span>
                               <span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">72</span><span class="p">]</span>
<span class="n">df_heating_70to72</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">/var/folders/3n/r5vj11ss7lzcdl10vfhb_mw00000gs/T/ipykernel_93904/3118749747.py</span> in <span class="ni">?</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">df_heating_70to72</span> <span class="o">=</span> <span class="n">df_heating</span><span class="p">[</span><span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">70</span> <span class="ow">and</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>                                <span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">72</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">df_heating_70to72</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="nn">~/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pandas/core/generic.py</span> in <span class="ni">?</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1575</span>     <span class="nd">@final</span>
<span class="g g-Whitespace">   </span><span class="mi">1576</span>     <span class="k">def</span> <span class="nf">__nonzero__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NoReturn</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1577</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1578</span>             <span class="sa">f</span><span class="s2">&quot;The truth value of a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is ambiguous. &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1579</span>             <span class="s2">&quot;Use a.empty, a.bool(), a.item(), a.any() or a.all().&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1580</span>         <span class="p">)</span>

<span class="ne">ValueError</span>: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
</pre></div>
</div>
</div>
</div>
<p>The problem here is that on the left and on the right of the logical <code class="docutils literal notranslate"><span class="pre">and</span></code> operator you have arrays of booleans not just booleans.
Python does not know what to do with them.
The correct operator to use to represent logical <code class="docutils literal notranslate"><span class="pre">AND</span></code> in this situation is <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> (which you can also read as <code class="docutils literal notranslate"><span class="pre">AND</span></code>).
Let’s try again.
This time we are going to get a really big error message.
I’m going to hide it.</p>
<div class="cell tag_hide-output tag_raises-exception docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_heating_70to72</span> <span class="o">=</span> <span class="n">df_heating</span><span class="p">[</span><span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">70</span> <span class="o">&amp;</span>
                               <span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">72</span><span class="p">]</span>
<span class="n">df_heating_70to72</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">File ~/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pandas/core/ops/array_ops.py:362,</span> in <span class="ni">na_logical_op</span><span class="nt">(x, y, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">353</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">354</span>     <span class="c1"># For exposition, write:</span>
<span class="g g-Whitespace">    </span><span class="mi">355</span>     <span class="c1">#  yarr = isinstance(y, np.ndarray)</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">360</span>     <span class="c1"># Then Cases where this goes through without raising include:</span>
<span class="g g-Whitespace">    </span><span class="mi">361</span>     <span class="c1">#  (xint or xbool) and (yint or bool)</span>
<span class="ne">--&gt; </span><span class="mi">362</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">363</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>

<span class="nn">File ~/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pandas/core/roperator.py:54,</span> in <span class="ni">rand_</span><span class="nt">(left, right)</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span> <span class="k">def</span> <span class="nf">rand_</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">54</span>     <span class="k">return</span> <span class="n">operator</span><span class="o">.</span><span class="n">and_</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">left</span><span class="p">)</span>

<span class="ne">TypeError</span>: ufunc &#39;bitwise_and&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">File ~/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pandas/core/ops/array_ops.py:376,</span> in <span class="ni">na_logical_op</span><span class="nt">(x, y, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">375</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">376</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">libops</span><span class="o">.</span><span class="n">scalar_binop</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">377</span> <span class="k">except</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">378</span>     <span class="ne">TypeError</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">379</span>     <span class="ne">ValueError</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">382</span>     <span class="ne">NotImplementedError</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">383</span> <span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>

<span class="nn">File ops.pyx:180,</span> in <span class="ni">pandas._libs.ops.scalar_binop</span><span class="nt">()</span>

<span class="ne">ValueError</span>: Buffer dtype mismatch, expected &#39;Python object&#39; but got &#39;double&#39;

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">72</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">df_heating_70to72</span> <span class="o">=</span> <span class="n">df_heating</span><span class="p">[</span><span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">70</span> <span class="o">&amp;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>                                <span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">72</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">df_heating_70to72</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="nn">File ~/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pandas/core/ops/common.py:76,</span> in <span class="ni">_unpack_zerodim_and_defer.&lt;locals&gt;.new_method</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span>             <span class="k">return</span> <span class="bp">NotImplemented</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span> <span class="n">other</span> <span class="o">=</span> <span class="n">item_from_zerodim</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">76</span> <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

<span class="nn">File ~/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pandas/core/arraylike.py:74,</span> in <span class="ni">OpsMixin.__rand__</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span> <span class="nd">@unpack_zerodim_and_defer</span><span class="p">(</span><span class="s2">&quot;__rand__&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="k">def</span> <span class="fm">__rand__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">74</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_logical_method</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">roperator</span><span class="o">.</span><span class="n">rand_</span><span class="p">)</span>

<span class="nn">File ~/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pandas/core/series.py:6130,</span> in <span class="ni">Series._logical_method</span><span class="nt">(self, other, op)</span>
<span class="g g-Whitespace">   </span><span class="mi">6127</span> <span class="n">lvalues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span>
<span class="g g-Whitespace">   </span><span class="mi">6128</span> <span class="n">rvalues</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">extract_numpy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">extract_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">6130</span> <span class="n">res_values</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">logical_op</span><span class="p">(</span><span class="n">lvalues</span><span class="p">,</span> <span class="n">rvalues</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">6131</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct_result</span><span class="p">(</span><span class="n">res_values</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">res_name</span><span class="p">)</span>

<span class="nn">File ~/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pandas/core/ops/array_ops.py:454,</span> in <span class="ni">logical_op</span><span class="nt">(left, right, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">450</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">451</span>     <span class="c1"># i.e. scalar</span>
<span class="g g-Whitespace">    </span><span class="mi">452</span>     <span class="n">is_other_int_dtype</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">is_integer</span><span class="p">(</span><span class="n">rvalues</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">454</span> <span class="n">res_values</span> <span class="o">=</span> <span class="n">na_logical_op</span><span class="p">(</span><span class="n">lvalues</span><span class="p">,</span> <span class="n">rvalues</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">456</span> <span class="c1"># For int vs int `^`, `|`, `&amp;` are bitwise operators and return</span>
<span class="g g-Whitespace">    </span><span class="mi">457</span> <span class="c1">#   integer dtypes.  Otherwise these are boolean ops</span>
<span class="g g-Whitespace">    </span><span class="mi">458</span> <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="ow">in</span> <span class="s2">&quot;iu&quot;</span> <span class="ow">and</span> <span class="n">is_other_int_dtype</span><span class="p">):</span>

<span class="nn">File ~/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pandas/core/ops/array_ops.py:385,</span> in <span class="ni">na_logical_op</span><span class="nt">(x, y, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">377</span>         <span class="k">except</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">378</span>             <span class="ne">TypeError</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">379</span>             <span class="ne">ValueError</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">382</span>             <span class="ne">NotImplementedError</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">383</span>         <span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">384</span>             <span class="n">typ</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
<span class="ne">--&gt; </span><span class="mi">385</span>             <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">386</span>                 <span class="sa">f</span><span class="s2">&quot;Cannot perform &#39;</span><span class="si">{</span><span class="n">op</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; with a dtyped [</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">] array &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">387</span>                 <span class="sa">f</span><span class="s2">&quot;and scalar of type [</span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="s2">]&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">388</span>             <span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
<span class="g g-Whitespace">    </span><span class="mi">390</span> <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="ne">TypeError</span>: Cannot perform &#39;rand_&#39; with a dtyped [float64] array and scalar of type [bool]
</pre></div>
</div>
</div>
</details>
</div>
<p>The problem here is the order in which the expression is evaluated.
The operator <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> has a special meaning in Python (we are not going to get into it) and it has high priority.
So, python tries to evaluate first <code class="docutils literal notranslate"><span class="pre">68</span> <span class="pre">&amp;</span> <span class="pre">df_heating['t_unit']</span></code> which is meanigless.
What needs to happen here is that is should first evaluate <code class="docutils literal notranslate"><span class="pre">df_heating['t_unit']</span> <span class="pre">&gt;=</span> <span class="pre">68</span></code> to get an array of booleans, then evaluate <code class="docutils literal notranslate"><span class="pre">df_heating['t_unit']</span> <span class="pre">&lt;</span> <span class="pre">70</span></code> to get another array of booleans, and the use <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> to logically compare the arrays pointwise.
We can enforce this order using parentheses.
Whatever Python expression is enclosed in parentheses will be evaluated first.
So, here is the correct way to do it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_heating_70to72</span> <span class="o">=</span> <span class="n">df_heating</span><span class="p">[(</span><span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">70</span><span class="p">)</span> <span class="o">&amp;</span>
                               <span class="p">(</span><span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">72</span><span class="p">)]</span>
<span class="n">df_heating_70to72</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>household</th>
      <th>date</th>
      <th>score</th>
      <th>t_out</th>
      <th>t_unit</th>
      <th>hvac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>a11</td>
      <td>2018-01-07</td>
      <td>58.0</td>
      <td>4.28</td>
      <td>71.55</td>
      <td>402.09</td>
    </tr>
    <tr>
      <th>17</th>
      <td>b18</td>
      <td>2018-01-07</td>
      <td>87.0</td>
      <td>4.28</td>
      <td>70.61</td>
      <td>368.15</td>
    </tr>
    <tr>
      <th>25</th>
      <td>b26</td>
      <td>2018-01-07</td>
      <td>97.0</td>
      <td>4.28</td>
      <td>70.01</td>
      <td>36.65</td>
    </tr>
    <tr>
      <th>29</th>
      <td>b30</td>
      <td>2018-01-07</td>
      <td>99.0</td>
      <td>4.28</td>
      <td>71.42</td>
      <td>23.68</td>
    </tr>
    <tr>
      <th>34</th>
      <td>c35</td>
      <td>2018-01-07</td>
      <td>96.0</td>
      <td>4.28</td>
      <td>70.56</td>
      <td>349.03</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Here is the plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">make_full_width_fig</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;All households&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_heating_70to72</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df_heating_70to72</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> 
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;t_unit in [70, 72)&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t_out (F)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;hvac (kWh)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">save_for_book</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;ch6.fig4&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/117dc7b7917c74b1f19d9ddb7c95875a71597d988302ecbc0b5efd5b6a77aa0f.svg" src="../_images/117dc7b7917c74b1f19d9ddb7c95875a71597d988302ecbc0b5efd5b6a77aa0f.svg" /></div>
</div>
<p>We see that the units with <code class="docutils literal notranslate"><span class="pre">t_unit</span></code> between 70 and 72 degrees F tend to consume less energy. There are some outliers, but the trend is clear.
What can explain the outliers though?
How can two households with the same internal temperature <code class="docutils literal notranslate"><span class="pre">t_unit</span></code> have very different energy consumption?
There are other variables here that we are not observing.
For example, the location of the unit in the building.
A unit that is at the corner of the building will have different heat loss than a unit that is in the middle of the building.
Another explanation is that the occupants may be opening the windows more often in one of the appartments.
Such variables are called \emph{confounding variables}.
You should always be on the lookout for them.</p>
<p>Let’s demonstrate a logical-or for selecting rows.
As you may have guessed <code class="docutils literal notranslate"><span class="pre">or</span></code> does not work.
We need to use the operator <code class="docutils literal notranslate"><span class="pre">|</span></code>.
And yes, we need to enclose everything in parentheses.
Let’s select the entries that highlight wasteful energy consuming behavior.
That would be units that have a very high <code class="docutils literal notranslate"><span class="pre">t_unit</span></code> (say above 78 degrees F) during heating or a very low <code class="docutils literal notranslate"><span class="pre">t_unit</span></code> during cooling (say below 70 degrees F).
Let’s see how much energy they consume.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_bad_behavior</span> <span class="o">=</span> <span class="n">df</span><span class="p">[((</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">55</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">78</span><span class="p">))</span> <span class="o">|</span>
                     <span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">55</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">70</span><span class="p">))]</span>
<span class="n">df_bad_behavior</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>household</th>
      <th>date</th>
      <th>score</th>
      <th>t_out</th>
      <th>t_unit</th>
      <th>hvac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>15</th>
      <td>a9</td>
      <td>2018-01-07</td>
      <td>39.0</td>
      <td>4.28</td>
      <td>78.71</td>
      <td>495.23</td>
    </tr>
    <tr>
      <th>22</th>
      <td>b23</td>
      <td>2018-01-07</td>
      <td>44.0</td>
      <td>4.28</td>
      <td>78.62</td>
      <td>359.17</td>
    </tr>
    <tr>
      <th>65</th>
      <td>a9</td>
      <td>2018-01-14</td>
      <td>41.0</td>
      <td>33.44</td>
      <td>78.56</td>
      <td>321.83</td>
    </tr>
    <tr>
      <th>72</th>
      <td>b23</td>
      <td>2018-01-14</td>
      <td>43.0</td>
      <td>33.44</td>
      <td>78.68</td>
      <td>197.92</td>
    </tr>
    <tr>
      <th>115</th>
      <td>a9</td>
      <td>2018-01-21</td>
      <td>41.0</td>
      <td>19.58</td>
      <td>78.57</td>
      <td>431.24</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">make_full_width_fig</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;All households&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_bad_behavior</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df_bad_behavior</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> 
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bad behavior&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t_out (F)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;hvac (kWh)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">save_for_book</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;ch6.fig5&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/613b4d54f29099e32689946c14320b638b739a1f69dc2e2f670ba7d3ca3fb1c8.svg" src="../_images/613b4d54f29099e32689946c14320b638b739a1f69dc2e2f670ba7d3ca3fb1c8.svg" /></div>
</div>
<p>Notice that they are some entries that exhibit bad behavior without being penalized with excessive energy consumption.
Can you think of a confounding variable that could explain this?
Here is what is happening:</p>
<ul class="simple">
<li><p>Units that are at the corners of the building expose at least two sides to the external environment.</p></li>
<li><p>Units that are on the top floor expose at least two sides to the external environment.</p></li>
<li><p>Units that are at a corner and on the top floor expose three sides to the external environment.</p></li>
<li><p>The rest of the units expose a single side to the external environment.
The first three groups (and especially the third group) are loosing a lot of energy to the environment and their energy consumption will in general be higher.
The final group is basically insulated from the environment and on top of that they may be getting heat energy from their neighbors.
Behaving badly in a top floor, corner unit will be reflected on your energy bill.
Behaving badly in an insulated unit may have no effect on your energy bill.</p></li>
</ul>
<p>Let’s end with logical-not for selecting rows.
Say we wanted to negate the previous selection so that we highlight all those who behaved well.
For this, you use the <code class="docutils literal notranslate"><span class="pre">~</span></code> operator in front of the logical expression you want to negate.
Like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_good_behavior</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="p">(((</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">55</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">72</span><span class="p">))</span> <span class="o">|</span>
                     <span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">55</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">75</span><span class="p">)))]</span>
<span class="n">df_good_behavior</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>household</th>
      <th>date</th>
      <th>score</th>
      <th>t_out</th>
      <th>t_unit</th>
      <th>hvac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a1</td>
      <td>2018-01-07</td>
      <td>100.0</td>
      <td>4.28</td>
      <td>66.69</td>
      <td>246.47</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a10</td>
      <td>2018-01-07</td>
      <td>100.0</td>
      <td>4.28</td>
      <td>66.36</td>
      <td>5.49</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a11</td>
      <td>2018-01-07</td>
      <td>58.0</td>
      <td>4.28</td>
      <td>71.55</td>
      <td>402.09</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a13</td>
      <td>2018-01-07</td>
      <td>100.0</td>
      <td>4.28</td>
      <td>63.92</td>
      <td>0.85</td>
    </tr>
    <tr>
      <th>7</th>
      <td>a16</td>
      <td>2018-01-07</td>
      <td>56.0</td>
      <td>4.28</td>
      <td>66.91</td>
      <td>529.84</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Again, pay attention to the parentheses because they are critical for the correct evaluation of the expression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">make_full_width_fig</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;All households&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_good_behavior</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df_good_behavior</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> 
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Good behavior&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">2</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t_out (F)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;hvac (kWh)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">save_for_book</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;ch6.fig6&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/042621ecc2d4af3c86f017be1d071aa2f429938abdfe7bcfccfab705ea0ad6d3.svg" src="../_images/042621ecc2d4af3c86f017be1d071aa2f429938abdfe7bcfccfab705ea0ad6d3.svg" /></div>
</div>
<p>Most households behaving well consume less than 100 kWh of energy per week.
However, there are some units that are using excellent temperature set points, but they are still consuming a lot of energy. This could be because of the confounding variables we discussed earlier. For example, the unit could be in a corner and the occupants could be opening the windows more often.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lecture06"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="python-loops.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Python loops</p>
      </div>
    </a>
    <a class="right-next"
       href="homework_06.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Homework 6</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-rows-that-satisfy-single-boolean-expression">Extract rows that satisfy single boolean expression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#questions">Questions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-timeseries-data">Plotting timeseries data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Questions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Questions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-rows-that-satisfy-more-complicated-boolean-expressions">Extract rows that satisfy more complicated boolean expressions</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ilias Bilionis (ibilion[at]purdue.edu)
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>